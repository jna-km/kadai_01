## 2025-07-10 当日予定

### 🔍 本日のタスクに関する事前検討・留意点

- 【レスポンス構造】成功・失敗時のレスポンス構造（status, message, data/errors）を統一する必要がある。エンドポイントによって構造が揃っていない場合は要調整。
- 【Postman検証】422, 401, 404 など典型的な異常系を一括検証し、Laravelのデフォルトレスポンスが紛れていないか確認したい。
- 【Swagger設計】components.schemas の再利用性を意識しつつ、バリデーション仕様との重複記述が発生しないよう粒度に注意する。
- 【補足計画】所感や試行錯誤などは各時間帯ブロックの下に追記予定。特に後半に食い込んだ作業は明示的に記録する。

### 9:00〜9:30 1日のやること整理と前日の作業確認  
- 本日のタスク全体を確認し、進行順序と重点箇所を仮整理する予定。  
- 昨日までのCRUDコントローラ実装とバリデーション設計の状況を振り返り、API仕様書フェーズへのスムーズな接続を意識する。  
- レスポンス形式やルーティング定義などの整合性を中心に確認し、Postman／Swagger記述準備に向けた着眼点を洗い出す。

### 9:30〜10:30 APIレスポンス設計の統一  
- エンドポイント間で共通するレスポンス構造（status, message, errorsなど）を整理し、フォーマット統一方針を検討する予定。  
- 正常系・異常系それぞれの設計パターンを並べ、今後のAPIレスポンス仕様の共通化に向けた方針を明文化する。

### 10:30〜11:30 PostmanによるAPI動作確認  
- User／Reservationエンドポイントを対象に、CRUD操作における正常・異常レスポンスの挙動を手動検証する。  
- バリデーションメッセージの表示やエラー構造の出力内容を確認し、レスポンス設計との整合性を把握する予定。改善ポイントがあれば別途記録する。

※補足・所感（例：作業時間が後ろに食い込んだ場合はここに記録）  
<!-- 所感などの記述エリア：必要に応じて追記 -->


### 11:30〜12:00 Swagger記述準備  
- OpenAPI形式に沿って、paths・parameters・response構造を仮整理する。  
- これまでの設計や実装内容を参照しながら、定義に不足や曖昧さがないかを洗い出し、午後の記述作業に備える予定。

### 13:00〜14:00 Swagger記述のベース設計  
- OpenAPI仕様に基づき、各paths・components・responsesの構成方針を整理。  
- 主要エンドポイントについて、共通のレスポンス構造や再利用できるスキーマ定義の草案をまとめる予定。

※補足（予定段階の整理）：  
- 【工夫】レスポンススキーマを components.responses に切り出すことで、定義の重複を避けた再利用構成にできる見込み。  
- 【気づき】description を省略するとSwagger UI上での表示が曖昧になる可能性があるため、最低限の説明文を追記する方針。

### 14:00〜15:00 schema・レスポンス例・パラメータ定義  
- リクエストbody・クエリパラメータ・レスポンスbodyをそれぞれ定義し、レスポンス例と共に整備する予定。  
- バリデーション仕様やコード実装との整合性を確認しながら記述。

※補足（事前懸念と設計方針）：  
- 【試行錯誤】`required` の項目をつけすぎるとSwagger上でExampleがエラー表示になる可能性があるため、用途ごとに入力制約を整理する必要がある。  
- 【工夫】特定のパラメータには `nullable: true` を活用し、柔軟な設計を想定している。

### 15:00〜15:15 休憩  
- コーヒーと軽いストレッチでリフレッシュ

### 15:15〜16:00 コード・レスポンス微修正（Swaggerとの整合性）  
- 実装済みAPIとSwagger記述の差異を確認し、レスポンス構造の微修正やコメントの調整を実施予定。

※補足（想定される修正・確認事項）：  
- 【気づき】Laravelのバリデーションエラー時レスポンスとSwagger定義にズレがある可能性があり、Swagger側をLaravel仕様に合わせる必要がある。  
- 【所感】実装と仕様が乖離しないよう、初期段階で整備しておく重要性があると考えている。

### 16:00〜17:00 GitHubへのコミット／ドキュメント整備  
- `swagger.yaml` とAPI定義markdownをGitHubに反映。ファイル構成とコメントを整えて他者が読める状態に調整する予定。

### 17:00〜18:00 README・Notion等への転記・仕様共有  
- 仕様策定の目的・背景を記述し、NotionやREADMEに転記。チーム全体での仕様理解を促す予定。

- 17:40〜18:00：Swagger UI確認
  - Postmanで作成したopenapi.yamlを `src/public/docs/swagger/openapi.yaml` に設置し、Swagger UIで表示確認。設定ミスにより一時的に403や404が出たが、nginx設定やファイル配置、権限調整で解決。
  - 画像記録：`docs/img/20250710_test_swagger.png`


## Postmanによる予約API動作確認ログ（2025/07/10）

Postmanにて予約APIの一連の動作確認を実施。以下のような操作を順に実施し、バリデーションやレスポンス仕様も含めて整合性を確認した。

### 所感・補足
- 最初の操作にやや時間がかかった（特に認証トークンの扱いとBodyの構成）
- 作成／更新時のバリデーションメッセージが確認しやすかった
- 今後はSwaggerと連携して入力補助を使いたい

### スクリーンショット（操作の流れ）

1. ログイン（アクセストークン取得）  
   ![](../img/20250710_test_01_login.png)

2. 一覧取得（GET）  
   ![](../img/20250710_test_02_list.png)

3. 新規作成（バリデーションエラー）  
   ![](../img/20250710_test_03_add_er.png)

4. 新規作成（成功）  
   ![](../img/20250710_test_04_add.png)

5. 詳細取得  
   ![](../img/20250710_test_05_details.png)

6. 更新処理  
   ![](../img/20250710_test_06_edit.png)

7. 削除処理  
   ![](../img/20250710_test_07_delete.png)



### 🧪 Swagger UI 動作確認

- Postmanによる一連の予約API動作確認に加えて、Swagger UI による API ドキュメントの表示と操作確認を実施。
  - Swagger UI 表示URL：`http://localhost:88/swagger/`
  - OpenAPI仕様ファイル（`openapi.yaml`）を `public/swagger/` に配置。
  - 表示確認に成功し、API定義とレスポンス確認が可能に。
  - Postman で作成した予約APIのテスト内容と同等の動作を Swagger UI 上で確認。
- テスト結果画像追加：   ![](../img/20250710_test_swagger.png)


--- フッター開始 ---

[← READMEに戻る](../../README.md)

## 📚 ドキュメント一覧

- [プロジェクト概要](../project-overview.md)
- [機能一覧](../features.md)
- [画面・機能対応表](../function_screen_map.md)
- [画面定義](../screens.md)
- [ユースケース定義](../usecase_reserve.md)
- [機能要件](../functional_requirements.md)
- [コーディングルール](../coding-rules.md)
- [APIレスポンス設計ガイドライン](../api_response.md)
- [ショートカット](../shortcuts.md)
- [UI改善ガイド](../ui_improvement_guide.md)
- [Laravel + Supervisor 設定ガイド](../supervisor.md)
- [画面遷移図（PDF）](../画面遷移図.pdf)
- [ワイヤーフレーム（PDF）](../ワイヤーフレーム.pdf)

### 作業ログ
- [2025-07-07](../logs/2025-07-07.md)
- [2025-07-08](../logs/2025-07-08.md)
- [2025-07-09](../logs/2025-07-09.md)
- [2025-07-10](../logs/2025-07-10.md)
- [2025-07-11](../logs/2025-07-11.md)
- [2025-07-15](../logs/2025-07-15.md)
- [2025-07-17](../logs/2025-07-17.md)
- [2025-07-18](../logs/2025-07-18.md)
- [2025-07-22](../logs/2025-07-22.md)
- [2025-07-23](../logs/2025-07-23.md)
- [2025-07-24](../logs/2025-07-24.md)
- [2025-07-25](../logs/2025-07-25.md)
- [2025-07-28](../logs/2025-07-28.md)
- [2025-07-29](../logs/2025-07-29.md)

### 色々やること
- [今後のTODOメモ](../todo.md)

--- フッター終了 ---
